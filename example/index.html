<!doctype html>

<html>

<head>
  <title>WebRTC video streaming demo using Nabto</title>
  <meta charset="utf-8">
  <link href="styles.css" rel="stylesheet">
  <script src="nabtoBundle.js"></script>
  <script src="util.js"></script>
  <script src="webclient.js"></script>
</head>

<body>
  <div class="container">
    <form class="infobox">
      <section>
        <h1>Nabto WebRTC browser demo</h1>
      </section>
      <section>
        <label for="devicelink">Pairing link to parse for device info: </label>
        <input id="devicelink" type="text" required inputmode="verbatim" size="140" value="">
        <input id="linkparse" type="button" name="linkparse" value="Parse" onclick="parseLink()">
      </section>
      <section>
        <table>
          <tr>
            <td><label for="product">Product ID: </label></td>
            <td><input id="product" type="text" maxlength="12" required inputmode="verbatim" value=""
                onchange="storeInfo()"></td>
            <td></td>
            <td><label for="fp">Fingerprint: </label></td>
            <td><input id="fp" type="text" maxlength="64" inputmode="verbatim" value="" size="55"
                onchange="storeInfo()"></td>
          </tr>
          <tr>
            <td><label for="device">Device ID: </label></td>
            <td><input id="device" type="text" maxlength="12" required inputmode="verbatim" value=""
                onchange="storeInfo()"></td>

            <td></td>
            <td><label for="iamuser">IAM username: </label></td>
            <td><input id="iamuser" type="text" maxlength="64" inputmode="verbatim" value="" onchange="storeInfo()">
            </td>
          </tr>
          <tr>
            <td><label for="sct">SCT: </label></td>
            <td><input id="sct" type="text" maxlength="12" required inputmode="verbatim" value=""
                onchange="storeInfo()"></td>

            <td style="width: 60px;"></td>
            <td><label for="iampwd">IAM password: </label></td>
            <td><input id="iampwd" type="text" maxlength="64" inputmode="verbatim" value="" onchange="storeInfo()"></td>
          </tr>

        </table>
      </section>

    </form>
    <div class="controlbox">
      <section>
        <input id="login" type="button" name="login" value="Connect" onclick="connect()">
        <input id="passauth" type="button" name="passAuth" value="Password Authenticate" onclick="passAuth()" disabled>
        <input id="fpvalid" type="button" name="fpValid" value="Validate Fingerprint" onclick="validateFingerprint()"
          disabled>
        <input id="audiodown" type="button" name="audiodown" value="Add Downstream Audio" onclick="downstreamAudio()"
          disabled>
        <input id="videodown" type="button" name="videodown" value="Add Downstream Video" onclick="downstreamVideo()"
          disabled>
      </section>
      <section>
      </section>
      <section style="border: 1px solid; max-width: 1500px; margin-top: 5px">
        <div style="margin: 10px;">
          <h2>CoAP Requests</h2>
          <section>
            <input id="inforeq" type="button" name="inforeq" value="Set Signaling Info Request"
              onclick="setSignalingReq()">
            <input id="videoreq" type="button" name="videoreq" value="Set Video Request" onclick="setVideoReq()">
            <input id="videoaudioreq" type="button" name="videoaudioreq" value="Set Video/Audio Request"
              onclick="setVideoAudioReq()">
            <input id="tracksreq" type="button" name="tracksreq" value="Set Default Tracks Request"
              onclick="setDefaultTracksReq()">
            <input id="oauth" type="button" name="oAuth" value="Set Oauth Request" onclick="setOauthReq()" disabled>

          </section>
          <section>
            <label for="oauthtoken">Oauth Token: </label>
            <input id="oauthtoken" type="text" maxlength="1024" inputmode="verbatim" value="" onchange="updateUi()">
          </section>
          <section>
            <label for="coapmethod">Method: </label>
            <input id="coapmethod" type="text" maxlength="7" size="6" inputmode="verbatim" value=""
              onchange="updateUi()">
            <label for="coappath">Path: </label>
            <input id="coappath" type="text" inputmode="verbatim" value="" onchange="updateUi()">
            <label for="coapct">Content Type: </label>
            <input id="coapct" type="number" style="width:3em" value="">
            <label for="coappayload">Payload: </label>
            <input id="coappayload" type="text" inputmode="verbatim" value="">

            <input id="coap" type="button" name="coap" value="Invoke CoAP" onclick="coapInvoke()" disabled>
          </section>
        </div>
      </section>
      <section style="border: 1px solid; max-width: 1500px; margin-top: 10px;">
        <div style="margin: 10px;">
          <h3>Datachannel</h3>
          <label for="dclabel">Label: </label>
          <input id="dclabel" type="text" maxlength="1024" inputmode="verbatim" value="" onchange="updateUi()">
          <input id="createDc" type="button" name="createDc" value="Create Datachannel" onclick="createDatachannel(dclabel.value)" disabled>
          <div id="dcsenddiv" hidden="true">
            <label for="dcin">Input data: </label>
            <input id="dcin" type="text" maxlength="1024" inputmode="verbatim" value="">
            <input id="dcSend" type="button" name="dcSend" value="Send" onclick="datachannelSend(dcin.value)">
          </div>
        </div>
      </section>
    </div>
    <ul class="logbox">
      <li><b>LOG:</b><input id="clearlog" type="button" name="clearlog" value="Clear Log" onclick="clearLog()"> </li>
    </ul>
    <div class="camerabox">
      <video id="received_video" autoplay></video>
      <audio id="received_audio" autoplay></audio>
    </div>
  </div>
</body>

</html>
